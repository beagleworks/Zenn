# 実装計画

- [ ] 1. プロジェクト構造とHTML基盤の作成
  - HTMLファイル、CSSファイル、JavaScriptファイルの基本構造を作成
  - Canvas要素とUI要素の配置
  - 基本的なスタイリングの実装
  - _要件: 8.1, 8.2, 8.3, 8.5_

- [ ] 2. ブロック定義システムの実装
  - [ ] 2.1 基本ブロック定義の作成
    - 11種類のブロック（テトロミノ7種類 + モノミノ + ドミノ + トリオミノ2種類）の形状と色を定義
    - ブロック回転機能の実装
    - ブロック定義の単体テストを作成
    - _要件: 2.1-2.12_

  - [ ] 2.2 BlockSystemクラスの実装
    - ランダムブロック生成機能を実装
    - 次ブロックの管理機能を実装
    - ブロック回転と移動の基本機能を実装
    - BlockSystemの単体テストを作成
    - _要件: 2.1-2.12, 5.1, 5.2_

- [ ] 3. ゲームフィールドとレンダリングシステムの実装
  - [ ] 3.1 GameFieldクラスの実装
    - 20×10のゲームフィールドを2次元配列で実装
    - ブロック配置機能を実装
    - 境界チェック機能を実装
    - GameFieldの単体テストを作成
    - _要件: 8.1_

  - [ ] 3.2 基本レンダリング機能の実装
    - Canvasへの基本描画機能を実装
    - ゲームフィールドの描画機能を実装
    - ブロックの描画機能を実装（色分けを含む）
    - 描画機能の動作確認テストを作成
    - _要件: 8.1, 8.2, 8.3, 8.4, 2.12_

- [ ] 4. 衝突検出システムの実装
  - 衝突検出アルゴリズムを実装
  - 境界衝突の検出機能を実装
  - ブロック間衝突の検出機能を実装
  - 衝突検出の単体テストを作成
  - _要件: 1.5_

- [ ] 5. 基本的なブロック操作の実装
  - [ ] 5.1 ブロック移動機能の実装
    - 左右移動機能を実装
    - 下方向移動機能を実装
    - 移動時の衝突チェックを統合
    - 移動機能の単体テストを作成
    - _要件: 1.1, 1.2, 1.3, 1.5_

  - [ ] 5.2 ブロック回転機能の実装
    - 時計回りの回転機能を実装
    - 回転時の衝突チェックを統合
    - 回転機能の単体テストを作成
    - _要件: 1.4, 1.5_

- [ ] 6. 入力処理システムの実装
  - InputHandlerクラスを実装
  - キーボード入力の処理を実装（矢印キー、スペースキー）
  - 入力とブロック操作の連携を実装
  - 入力処理の単体テストを作成
  - _要件: 1.1, 1.2, 1.3, 1.4_

- [ ] 7. ゲームループとブロック自動落下の実装
  - [ ] 7.1 基本ゲームループの実装
    - requestAnimationFrameを使用したゲームループを実装
    - 固定タイムステップの更新処理を実装
    - ゲームループの動作確認テストを作成
    - _要件: 4.4_

  - [ ] 7.2 ブロック自動落下機能の実装
    - タイマーベースの自動落下を実装
    - レベルに応じた落下速度調整を実装
    - 自動落下機能の単体テストを作成
    - _要件: 4.4_

- [ ] 8. ライン消去システムの実装
  - [ ] 8.1 ライン検出機能の実装
    - 完成ラインの検出アルゴリズムを実装
    - 複数ライン同時検出機能を実装
    - ライン検出の単体テストを作成
    - _要件: 3.1_

  - [ ] 8.2 ライン消去とブロック落下の実装
    - ライン消去機能を実装
    - 上部ブロックの落下処理を実装
    - ライン消去機能の単体テストを作成
    - _要件: 3.1, 3.2_

- [ ] 9. スコアとレベル管理システムの実装
  - [ ] 9.1 ScoreManagerクラスの実装
    - スコア計算機能を実装（1-4ライン消去に対応）
    - レベル管理機能を実装
    - ライン数カウント機能を実装
    - ScoreManagerの単体テストを作成
    - _要件: 3.3, 3.4, 3.5, 3.6, 4.1, 4.2, 4.3, 4.5_

  - [ ] 9.2 UI表示機能の実装
    - スコア、レベル、ライン数の表示機能を実装
    - リアルタイム更新機能を実装
    - UI表示の動作確認テストを作成
    - _要件: 4.1, 4.2, 4.5_

- [ ] 10. プレビューとスキップ機能の実装
  - [ ] 10.1 次ブロックプレビューの実装
    - プレビューエリアの描画機能を実装
    - 次ブロックの表示機能を実装
    - プレビュー更新機能を実装
    - プレビュー機能の単体テストを作成
    - _要件: 5.1, 5.2, 5.3_

  - [ ] 10.2 スキップ機能の実装
    - スキップスタック管理機能を実装
    - スキップ操作の処理を実装
    - スキップスタック回復機能を実装
    - スキップスタック数の表示機能を実装
    - スキップ機能の単体テストを作成
    - _要件: 5.4, 5.5, 5.6, 5.7, 5.8, 5.9_

- [ ] 11. ゲーム状態管理の実装
  - [ ] 11.1 ゲームオーバー処理の実装
    - ゲームオーバー判定機能を実装
    - ゲームオーバー画面の表示機能を実装
    - 新しいゲーム開始機能を実装
    - ゲームオーバー処理の単体テストを作成
    - _要件: 6.1, 6.2, 6.3, 6.4_

  - [ ] 11.2 ポーズ機能の実装
    - ポーズ状態の管理機能を実装
    - ポーズ画面の表示機能を実装
    - ポーズ/再開の入力処理を実装
    - ポーズ機能の単体テストを作成
    - _要件: 7.1, 7.2, 7.3, 7.4_

- [ ] 12. 統合とテスト
  - [ ] 12.1 全機能の統合
    - すべてのコンポーネントを統合
    - ゲーム全体の動作確認
    - 統合テストの実行
    - _要件: 全要件_

  - [ ] 12.2 ユーザビリティとパフォーマンステスト
    - 60FPS動作の確認とパフォーマンス最適化
    - キー操作の応答性テスト
    - 長時間プレイでの安定性テスト
    - _要件: 8.5_

- [ ] 13. 最終調整とポリッシュ
  - 視覚効果の追加（ライン消去エフェクトなど）
  - 音響効果の実装（オプション）
  - モバイル対応の最終調整
  - 最終的な動作確認とバグ修正
  - _要件: 8.4, 8.5_